//tealium universal tag - utag.147 ut4.0.201607142045, Copyright 2016 Tealium.com Inc. All Rights Reserved.
var CONFIG={SEARCH_ENGINES:{GOOGLE:{NAME:"Google",QP:"q",HOST:"google"},YAHOO:{NAME:"Yahoo",QP:"p",HOST:"yahoo"},BING:{NAME:"Bing",QP:"q",HOST:"bing"},ASK:{NAME:"Ask",QP:"q",HOST:"ask"}}};var _result;var tapadBaseUrl='https://tapestry.tapad.com/tapestry/1?ta_partner_id=';var tapadPartnerId;function trackRequest(referrerURL,currentURL,cmpId,additionalParams){_result=checkReferrer(referrerURL,currentURL,cmpId);if((_result.modeOfAccess!="DIRECT")&&(additionalParams!=null)){var referrerURLParams=parseUri(referrerURL);var referrerHost=referrerURLParams.host;_result=checkCustomAccessModes(referrerHost,additionalParams,_result);}
_result.randomId=Math.floor(Math.random()*100001);_result.timestamp=new Date().getTime();_result.Utils=Utils;return _result;}
function checkCustomAccessModes(referrerHost,additionalParams,result){result=checkCustomModeByRefferer(referrerHost,additionalParams,result);result=checkCustomModeByCurrentPageParams(referrerHost,additionalParams,result);return result;}
function checkCustomModeByCurrentPageParams(referrerHost,additionalParams,result){var custommodes=additionalParams["CUSTOM_ACCESS_MODES_BY_CURRENT_PAGE_PARAMS"];var found=false;var cHost;for(var mode in custommodes){var custommode=custommodes[mode];for(i=0;i<custommode.length;i++){if(result.current_page_params.queryKey.hasOwnProperty(custommode[i])){result.source=referrerHost;result.modeOfAccess=mode;found=true;break;}}
if(found){break;}}
return result;}
function checkCustomModeByRefferer(referrerHost,additionalParams,result){var custommodes=additionalParams["CUSTOM_ACCESS_MODES_BY_REFERRER"];var found=false;var cHost;for(var mode in custommodes){var custommode=custommodes[mode];for(i=0;i<custommode.length;i++){cHost=custommode[i];if(referrerHost.indexOf(cHost.toLowerCase())!=-1){result.source=cHost;result.modeOfAccess=mode;found=true;break;}}
if(found){break;}}
return result;}
function checkReferrer(referrerURL,currentURL,cmpId){var result=new Object();var currentURLParams=parseUri(currentURL);result.current_page_params=currentURLParams;result.modeOfAccess="UNKNOWN";result.source="NONE";result.isSearchEngine=false;if(!referrerURL||(referrerURL==null)||(referrerURL=="")){result.isRequestTracked=false;result.isSearchEngine=false;result.modeOfAccess="DIRECT";}else{var searchEngines=CONFIG.SEARCH_ENGINES;var referrerURLParams=parseUri(referrerURL);result.referrer_page_params=referrerURLParams;var referrerHost=referrerURLParams.host;for(var i in searchEngines){var searchEngine=searchEngines[i];if(referrerHost.indexOf(searchEngine.HOST)!=-1){result.source=searchEngine.NAME;result.isSearchEngine=true;result.modeOfAccess="ORGANIC";result.query=referrerURLParams['queryKey'][searchEngine.QP];result.isRequestTracked=validateCampaignIds(currentURLParams.queryKey,cmpId,referrerHost);if(result.isRequestTracked){result.modeOfAccess="PAID";}
break;}}
if(!result.isSearchEngine){result.source=encodeURI(referrerURL);result.isSearchEngine=false;result.isRequestTracked=validateCampaignIds(currentURLParams.queryKey,cmpId,referrerHost);if(result.isRequestTracked){result.modeOfAccess="DISPLAY";}else{result.modeOfAccess="UNKNOWN";}}}
return result;}
function validateCampaignIds(targetObject,domainIds,referrerHost){var campainIdExistance=false;for(var domainval in domainIds){var cmpIds=domainIds[domainval];for(var cmpId in cmpIds){if(hasCampaignID(targetObject,cmpIds[cmpId])&&(domainval=="*"||referrerHost.indexOf(domainval.toLowerCase())!=-1)){return true;};}}
return campainIdExistance;}
function hasCampaignID(targetObject,cmpId){if(cmpId.indexOf('*')!=-1){return hasWildCardMatch(targetObject,cmpId)}
return(cmpId!=null)&&(targetObject.hasOwnProperty(cmpId));}
function hasWildCardMatch(targetObject,cmpId){var matches=false;cmpId=cmpId.replace(/\*/g,"");var patternstr="^"+cmpId;var pattern=new RegExp(patternstr,"g");for(var key in targetObject){if(pattern.test(key)){matches=true;break;}}
return matches;}
function parseUri(str){var	o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--)uri[o.key[i]]=m[i]||"";uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1)uri[o.q.name][$1]=$2;});return uri;};parseUri.options={strictMode:true,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@?]*)(?::([^:@?]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@?]*)(?::([^:@?]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};function IQSeoTag(referrerURL,currentURL,cmpId,additionalParams){if(typeof additionalParams['TAPAD_PARTNERID']==='undefined'){tapadPartnerId=950;}else{tapadPartnerId=additionalParams['TAPAD_PARTNERID'];}
return trackRequest(referrerURL,currentURL,cmpId,additionalParams)}
function valueMatches(list,val){for(var li=0,listlen=list.length;li<listlen;li++){if(list[li].substring){if(list[li].toLowerCase()==val){return true;}}}
return false;}
var Utils={valueMatches:valueMatches,getTapadPixel:function(adpixel,postfix){var tapadUrl='';if(typeof postfix==='undefined'){postfix='';}
adpixel=adpixel+'TAPAD_${IDS:key}'+postfix;tapadUrl=tapadBaseUrl+tapadPartnerId+'&ta_redirect='+encodeURIComponent(adpixel);return tapadUrl;},getCurrentPageParamsKey:function(queryKeyName){queryKeyName=queryKeyName.toLowerCase();if(_result.current_page_params.queryKey[queryKeyName])
{return _result.current_page_params.queryKey[queryKeyName];}
else
{if(_result.current_page_params.source.toLowerCase().indexOf(queryKeyName+"=")>-1){var queryKeyValue=_result.current_page_params.source.toLowerCase().split(queryKeyName+"=");queryKeyValue=queryKeyValue[1].split("&");_result.current_page_params.queryKey[queryKeyName]=queryKeyValue[0];return _result.current_page_params.queryKey[queryKeyName];}
else
{return;}}},getReferrerPageParamsKey:function(queryKeyName){queryKeyName=queryKeyName.toLowerCase();if(_result.referrer_page_params.queryKey[queryKeyName])
{return _result.referrer_page_params.queryKey[queryKeyName];}
else
{if(_result.referrer_page_params.source.toLowerCase().indexOf(queryKeyName+"=")>-1){var queryKeyValue=_result.referrer_page_params.source.toLowerCase().split(queryKeyName+"=");queryKeyValue=queryKeyValue[1].split("&");_result.referrer_page_params.queryKey[queryKeyName]=queryKeyValue[0];return _result.referrer_page_params.queryKey[queryKeyName];}
else
{return;}}},getReferrerPageParams:function(){if(!_result.referrer_page_params.query=="")
{return _result.referrer_page_params.query;}
else
{if(_result.referrer_page_params.path.indexOf("&")>-1||_result.referrer_page_params.path.indexOf("=")>-1){var dir_temp=_result.referrer_page_params.path.split("/");_result.referrer_page_params.query="";var slash_temp="";for(var il=0;il<dir_temp.length;il++){if(dir_temp[il].indexOf("=")>-1||slash_temp=="/"){_result.referrer_page_params.query=_result.referrer_page_params.query+slash_temp+dir_temp[il];slash_temp="/";}}
return _result.referrer_page_params.query;}}},getCurrentPageParams:function(){if(!_result.current_page_params.query=="")
{return _result.current_page_params.query;}
else
{if(_result.current_page_params.path.indexOf("&")>-1||_result.current_page_params.path.indexOf("=")>-1){var dir_temp=_result.current_page_params.path.split("/");_result.current_page_params.query="";var slash_temp="";for(var il=0;il<dir_temp.length;il++){if(dir_temp[il].indexOf("=")>-1||slash_temp=="/"){_result.current_page_params.query=_result.current_page_params.query+slash_temp+dir_temp[il];slash_temp="/";}}
return _result.current_page_params.query;}}},tolowercaseCurrentPageParamsKeys:function(){if(_result.current_page_params&&_result.current_page_params.queryKey){for(key in _result.current_page_params.queryKey){if(key.toLowerCase()!=key){_result.current_page_params.queryKey[key.toLowerCase()]=_result.current_page_params.queryKey[key];delete _result.current_page_params.queryKey[key];}}}},getCookieVIQ:function(c_name){var c_value=document.cookie;var c_start=c_value.indexOf(c_name+"=");if(c_start==-1){c_start=c_value.indexOf(c_name+"=");}
if(c_start==-1){c_value=null;}
else{c_start=c_value.indexOf("=",c_start)+1;var c_end=c_value.indexOf(";",c_start);if(c_end==-1){c_end=c_value.length;}
c_value=decodeURIComponent(c_value.substring(c_start,c_end));}
return c_value;},setCookieVIQ:function(c_name,value){var exdate=new Date();var c_value=encodeURIComponent(value);document.cookie=c_name+"="+c_value;return;},checkCookieVIQ:function(c_name){var domainname=_result.Utils.getCookieVIQ(c_name);if(domainname!=null&&domainname!=""){return domainname;}
else{return"false";}}}
window.IQSeoTag=IQSeoTag;try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1};u.initialized=false;u.map={};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
var CURRENT_URL=decodeURIComponent(document.URL);var REFERRER_URL=document.referrer;var additionalParameters={CUSTOM_ACCESS_MODES_BY_REFERRER:{SOCIAL_ORGANIC:["facebook.com","twitter.com","pinterest.com","plus.google.com","plus.url.google.com"],ADDITIONAL_ORGANIC:["baidu","yandex"]}}
var additionalSearchEngineParams={baidu:{Name:"baidu",QueryKey:"wd"},yandex:{Name:"yandex",QueryKey:"text"},}
var p=/^http:/.test(document.location)?'http':'https';var result=new IQSeoTag(REFERRER_URL,CURRENT_URL,null,additionalParameters);result.Utils.tolowercaseCurrentPageParamsKeys();var currentUrl=CURRENT_URL.toLowerCase();var imageURL;if(REFERRER_URL.length>0){var refURL=REFERRER_URL.split("//");var domainVal=refURL[1].split("/");if(domainVal[0]==="www.t.co"||domainVal[0]==="t.co"){result.modeOfAccess="SOCIAL_ORGANIC";}}
var referrerDomain;if(REFERRER_URL.length>0){var referrerDomain=REFERRER_URL.split("//")[1].split("/")[0];}
var currentDomain=CURRENT_URL.split("?")[0];if(result.Utils.checkCookieVIQ("domain.VIQ.CISCO")=='false')
{result.Utils.setCookieVIQ("domain.VIQ.CISCO","NewVisitor");if(CURRENT_URL.toLowerCase().indexOf("elqtrackid=")>-1||CURRENT_URL.toLowerCase().indexOf("elq=")>-1)
{imageURL="https://ad.doubleclick.net/ddm/ad/N7442.547841VISUALIQINC/B9697065.131431153;sz=1x1;u="+result.source+"-"+result.query+"-"+result.Utils.getCurrentPageParams()+"|"+REFERRER_URL+";ord=["+result.timestamp+"]?";}
else if(CURRENT_URL.toLowerCase().indexOf("emessenger")>-1)
{imageURL="https://ad.doubleclick.net/ddm/ad/N7442.547841VISUALIQINC/B9697065.131431153;sz=1x1;u="+result.source+"-"+result.query+"-"+result.Utils.getCurrentPageParams()+"|"+REFERRER_URL+";ord=["+result.timestamp+"]?";}
else if(result.modeOfAccess=="ORGANIC"&&typeof result.Utils.getCurrentPageParams()=="undefined")
{imageURL="https://ad.doubleclick.net/ddm/ad/N7442.547841VISUALIQINC/B9697065.131430528;sz=1x1;u="+result.source+"-"+result.query+"-"+result.Utils.getCurrentPageParams()+"|"+REFERRER_URL+";ord=["+result.timestamp+"]?";}
else if(result.modeOfAccess=="ADDITIONAL_ORGANIC"&&typeof result.Utils.getCurrentPageParams()=="undefined")
{var qkey=additionalSearchEngineParams[result.source].QueryKey;imageURL="https://ad.doubleclick.net/ddm/ad/N7442.547841VISUALIQINC/B9697065.131430528;sz=1x1;u="+result.source+"-"+result.referrer_page_params.queryKey[qkey]+"-"+result.Utils.getCurrentPageParams()+"|"+REFERRER_URL+";ord=["+result.timestamp+"]?";}
else if(result.modeOfAccess=="SOCIAL_ORGANIC"){if(currentUrl.indexOf("position=social%2bmedia%2bpaid")>-1||currentUrl.indexOf("position=social%2bmedia%2bpaidlink")>-1||currentUrl.indexOf("position=social%20media%20paid")>-1||currentUrl.indexOf("position=social%20media%20paidlink")>-1||currentUrl.indexOf("position=social+media+paidlink")>-1||currentUrl.indexOf("position=social+media+paid")>-1||currentUrl.indexOf("position=social media paidlink")>-1||currentUrl.indexOf("position=social media paid")>-1){imageURL="https://ad.doubleclick.net/ddm/ad/N7442.547841VISUALIQINC/B9697065.133556387;sz=1x1;u="+result.source+"-"+result.query+"-"+result.Utils.getCurrentPageParams()+"|"+REFERRER_URL+";ord=["+result.timestamp+"]?";}
else if(currentUrl.indexOf("social media")>-1||currentUrl.indexOf("social media organic")>-1||currentUrl.indexOf("social media share")>-1||currentUrl.indexOf("social")>-1||currentUrl.indexOf("socialoffers")>-1||currentUrl.indexOf("social_media")>-1||currentUrl.indexOf("social share")>-1||currentUrl.indexOf("socialmediaorganic")>-1||currentUrl.indexOf("socialmedia")>-1||currentUrl.indexOf("social_wechat")>-1||currentUrl.indexOf("social_weibo")>-1||currentUrl.indexOf("social_post")>-1||currentUrl.indexOf("social media org")>-1||currentUrl.indexOf("position=social%20media%20organic")>-1||currentUrl.indexOf("social-media")>-1||currentUrl.indexOf("social%20media")>-1||currentUrl.indexOf("social%252525252bmedia%252525252borganic")>-1||currentUrl.indexOf("position=social%20media%20share")>-1||currentUrl.indexOf("position=social%2bmedia%2borganic")>-1||currentUrl.indexOf("position=social%2bmedia%2bshare")>-1)
{imageURL="https://ad.doubleclick.net/ddm/ad/N7442.547841VISUALIQINC/B9697065.131431317;sz=1x1;u="+result.source+"-"+result.query+"-"+result.Utils.getCurrentPageParams()+"|"+REFERRER_URL+";ord=["+result.timestamp+"]?";}
else if(typeof result.Utils.getCurrentPageParams()=="undefined"){imageURL="https://ad.doubleclick.net/ddm/ad/N7442.547841VISUALIQINC/B9697065.131431317;sz=1x1;u="+result.source+"-"+result.query+"-"+result.Utils.getCurrentPageParams()+"|"+REFERRER_URL+";ord=["+result.timestamp+"]?";}
else
{}}
else if(result.modeOfAccess=="DIRECT")
{imageURL="https://ad.doubleclick.net/ddm/ad/N7442.547841VISUALIQINC/B9697065.131430502;sz=1x1;u="+result.Utils.getCurrentPageParams()+"|"+REFERRER_URL+";ord=["+result.timestamp+"]?";}
else if(referrerDomain.toLowerCase().indexOf("cisco.com")>-1)
{}}
if(imageURL){u.data.base_url=imageURL;u.loader({"type":"img","src":u.data.base_url});}
}};utag.o[loader].loader.LOAD(id);})("147","cisco.support");}catch(error){utag.DB(error);}
